{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/lior/Final_PRO Intel/IntelProject/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport { Component, Injectable } from '@angular/core';\nimport { Creditionals } from 'src/app/Models/Creditionals';\nimport { SaveUser } from 'src/app/Models/SaveUser';\nimport { UserModel } from 'src/app/Models/UserModel';\nlet MenuComponent = class MenuComponent {\n  constructor(ChatCCC, Home, ContactService, ServicePermission, router, Authentication_permissionService, s2) {\n    this.ChatCCC = ChatCCC;\n    this.Home = Home;\n    this.ContactService = ContactService;\n    this.ServicePermission = ServicePermission;\n    this.router = router;\n    this.Authentication_permissionService = Authentication_permissionService;\n    this.s2 = s2;\n    this.IsAccess = false;\n    this.Authentication_permissionsUser = {};\n    this.SaveLoginUserIfJWT = {};\n    this.Authentication_permissionsToken = [];\n    this.IsFailed_UserId = false;\n    this.IsFailed_UserPass = false;\n    this.Detailes_Uncorrect = false;\n    this.done = \"\";\n    this.ToShowPass = false;\n    this.ToHidePass = false;\n    this.SelectCCC = false;\n    this.SelectPassdown = false;\n    this.IfUserIsActive = false;\n    this.SaveJWT = \"\";\n    this.date = new Date();\n    this.Savedate = \"\";\n    this.creditionals = new Creditionals();\n    this.saveUser = new SaveUser();\n    this.IfUnauthorized = false;\n    this.CCC = 1;\n    this.TaskList = 0;\n    this.AddUser = new UserModel();\n    this.ActiveUsers = [];\n    this.CheckIfuserLogin = false;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.ActiveUrl = _this.router.url;\n      setTimeout(() => {\n        _this.IfLoginExoireToken();\n      }, 113000);\n    })();\n  }\n\n  checkIfLogin() {\n    if (localStorage.getItem(\"token\") == null) return true;else {\n      this.CheckIfuserLogin = true;\n      return false;\n    }\n  }\n\n  IfLoginExoireToken() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var _a;\n\n      let user = localStorage.getItem(\"User\");\n      _this2.SaveLoginUserIfJWT = yield _this2.Authentication_permissionService.GetNewUserCreditionalIfTokenUser_ExpireDate(user);\n      _this2.creditionals.username = _this2.SaveLoginUserIfJWT.user_name;\n      _this2.creditionals.password = _this2.SaveLoginUserIfJWT.pass;\n      _this2.AddUser.name = (_a = localStorage.getItem(\"User\")) === null || _a === void 0 ? void 0 : _a.toString();\n      yield _this2.ContactService.Delete_User(_this2.AddUser);\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"User\");\n      localStorage.removeItem(\"Command\");\n\n      _this2.login();\n    })();\n  }\n\n  AcceseeArea(val) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      var _a, _b;\n\n      try {\n        if (typeof localStorage.getItem(\"token\") === 'string') {\n          let ValToken = (_a = localStorage.getItem(\"token\")) === null || _a === void 0 ? void 0 : _a.toString();\n\n          if (typeof ValToken === 'string' && typeof ValToken != null) {\n            _this3.IsAccess = false;\n\n            if (val == 1) {\n              _this3.router.navigateByUrl(\"/CCC\");\n\n              _this3.IsAccess = false;\n              return;\n            } else if (val == 0) {\n              _this3.router.navigateByUrl(\"/TaskList\");\n\n              _this3.IsAccess = false;\n              return;\n            } else if (val == 3) {\n              _this3.router.navigateByUrl(_this3.router.url);\n\n              _this3.IsAccess = false;\n              return;\n            }\n          }\n        }\n\n        _this3.IsAccess = true;\n\n        if (val == 1) {\n          _this3.SelectCCC = true;\n          _this3.SelectPassdown = false;\n          return;\n        } else if (val == 0) {\n          _this3.SelectCCC = false;\n          _this3.SelectPassdown = true;\n          return;\n        }\n\n        if (val == 3) {\n          _this3.SelectCCC = false;\n          _this3.SelectPassdown = false;\n\n          _this3.router.navigateByUrl(_this3.router.url);\n        }\n\n        return;\n      } catch (ex) {\n        alert(ex.message);\n        _this3.AddUser.name = (_b = localStorage.getItem(\"User\")) === null || _b === void 0 ? void 0 : _b.toString();\n        yield _this3.ContactService.Delete_User(_this3.AddUser);\n        localStorage.removeItem(\"User\");\n        localStorage.removeItem(\"token\");\n        localStorage.removeItem(\"Command\");\n        _this3.IsAccess = true;\n\n        _this3.router.navigateByUrl(\"/Home\");\n      }\n    })();\n  }\n\n  login() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      var _a;\n\n      try {\n        _this4.ActiveUsers = yield _this4.ContactService.GetAllUsers();\n        let counter = 0;\n\n        _this4.ActiveUsers.map(x => {\n          if (x.name == _this4.creditionals.username) counter++;\n        });\n\n        if (counter > 0) {\n          _this4.IfUserIsActive = true;\n          setTimeout(() => {\n            _this4.IfUserIsActive = false;\n          }, 4000);\n          _this4.creditionals.username = \"\";\n          _this4.creditionals.password = \"\";\n          _this4.IsAccess = true;\n        } else {\n          _this4.Authentication_permissionsUser = yield _this4.Authentication_permissionService.GotToken(_this4.creditionals);\n\n          if (_this4.Authentication_permissionsUser.user_name != null && _this4.Authentication_permissionsUser.jwt_token != null) {\n            _this4.saveUser.username = _this4.Authentication_permissionsUser.first_name;\n            _this4.saveUser.jwt = _this4.Authentication_permissionsUser.jwt_token;\n            _this4.saveUser.RoleCommand = _this4.Authentication_permissionsUser._command;\n\n            if (_this4.saveUser.username != null && _this4.saveUser.jwt != null && _this4.saveUser.RoleCommand != null) {\n              localStorage.setItem(\"token\", _this4.saveUser.jwt);\n              localStorage.setItem(\"User\", _this4.saveUser.username);\n              localStorage.setItem(\"Command\", _this4.saveUser.RoleCommand);\n              _this4.IsAccess = false;\n              _this4.AddUser.name = (_a = localStorage.getItem(\"User\")) === null || _a === void 0 ? void 0 : _a.toString();\n              yield _this4.ContactService.AddUser(_this4.AddUser);\n\n              if (_this4.SelectCCC == true && _this4.SelectPassdown == false) {\n                if (typeof localStorage.getItem(\"User\") != null && typeof localStorage.getItem(\"User\") === 'string') {\n                  _this4.router.navigateByUrl(\"/CCC\");\n\n                  return;\n                }\n\n                return;\n              } else if (_this4.SelectCCC == false && _this4.SelectPassdown == true) {\n                _this4.router.navigateByUrl(\"/TaskList\");\n\n                return;\n              } else {\n                _this4.router.navigateByUrl(_this4.router.url);\n\n                return;\n              }\n            }\n          }\n        }\n      } catch (ex) {\n        if (ex.status == 401 || ex.status == 403 || ex.status == 400) _this4.IfUnauthorized = true;else alert(\"Some error ocuured, pls try again later\");\n        yield _this4.ContactService.Delete_User(_this4.AddUser);\n        localStorage.removeItem(\"User\");\n        localStorage.removeItem(\"token\");\n        localStorage.removeItem(\"Command\");\n        _this4.IsAccess = true;\n\n        _this4.router.navigateByUrl(\"/Home\");\n      }\n    })();\n  }\n\n  cancel() {\n    this.IsAccess = false;\n  }\n\n  ShowPass() {\n    var _a;\n\n    (_a = document.getElementById(\"pass\")) === null || _a === void 0 ? void 0 : _a.setAttribute(\"type\", \"text\");\n    this.ToShowPass = false;\n    this.ToHidePass = true;\n  }\n\n  HidePass() {\n    var _a;\n\n    (_a = document.getElementById(\"pass\")) === null || _a === void 0 ? void 0 : _a.setAttribute(\"type\", \"password\");\n    this.ToShowPass = true;\n    this.ToHidePass = false;\n  }\n\n  Hide_Alarm_Authorized() {\n    this.IfUnauthorized = false;\n    this.router.navigateByUrl(\"/Home\");\n  }\n\n  CheckIfStart(val) {\n    var _a;\n\n    if (val.target.value.length > 0) {\n      this.ToShowPass = true;\n      this.ToHidePass = false;\n    } else {\n      this.ToShowPass = false;\n      this.ToHidePass = false;\n      (_a = document.getElementById(\"pass\")) === null || _a === void 0 ? void 0 : _a.setAttribute(\"type\", \"password\");\n    }\n  }\n\n};\nMenuComponent = __decorate([Component({\n  selector: 'app-menu',\n  templateUrl: './menu.component.html',\n  styleUrls: ['./menu.component.css'],\n  styles: []\n}), Injectable({\n  providedIn: 'root'\n})], MenuComponent);\nexport { MenuComponent };","map":{"version":3,"sources":["C:\\Users\\lior\\Final_PRO Intel\\IntelProject\\src\\app\\components\\menu\\menu.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, Injectable, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Subscriber, Subscription } from 'rxjs';\nimport { Authentication_permissionsModel } from 'src/app/Models/Authentication_permissionsModel';\nimport { ContactArray } from 'src/app/Models/ContactArray';\nimport { Creditionals } from 'src/app/Models/Creditionals';\nimport { SaveUser } from 'src/app/Models/SaveUser';\nimport { UserModel } from 'src/app/Models/UserModel';\nimport { Authentication_permissionsService } from 'src/app/Services/Authentication_permissionsService';\nimport { ContactsOnlineService } from 'src/app/Services/ContactsOnlineService';\nimport { ServiceDataGLFollow } from 'src/app/Services/FollowDataService';\nimport { ModuleService } from 'src/app/Services/ModuleService';\nimport { HomeComponent } from '../home/home.component';\n\n@Component({\n  selector: 'app-menu',\n  templateUrl: './menu.component.html',\n  styleUrls: ['./menu.component.css']\n})\n@Injectable({\n  providedIn: 'root'\n})\nexport class MenuComponent implements OnInit {\n\n  constructor(public ChatCCC: CCCCom,public Home: HomeComponent,public ContactService: ContactsOnlineService,public ServicePermission : ServiceDataGLFollow ,public router: Router, public Authentication_permissionService : Authentication_permissionsService, public s2: ModuleService) { }\n  public IsAccess: boolean=false;\n  public User_id: any;\n  public Userpass: any;\n  public Authentication_permissionsUser: Authentication_permissionsModel   = {}\n  public SaveLoginUserIfJWT : Authentication_permissionsModel = {};\n  public Authentication_permissionsToken: Authentication_permissionsModel [] = [];\n\n  public IsFailed_UserId: boolean = false;\n\n  public IsFailed_UserPass: boolean = false;\n\n  public Detailes_Uncorrect: boolean = false;\n\n  public done: string=\"\";\n\n  public ToShowPass = false;\n\n  public ToHidePass = false;\n\n  public Select: any;\n\n   public SelectCCC = false;\n\n  public SelectPassdown= false;\n\n public IfUserIsActive = false;\n\n  public FirstName: any\n\n  public SaveJWT : string=\"\";\n\n  public date: Date = new Date();\n\n  public Savedate: string = \"\";\n\n  public ChoiceNavigate : any;\n  \n  public creditionals  = new Creditionals();\n\n  public saveUser =  new SaveUser();\n\n  public RefresheCreditional: any;\n\n  public IfUnauthorized = false;\n\n  public CCC:any=1;\n\n  public TaskList:any=0;\n\n  public AddUser : UserModel = new UserModel();\n\n  public ActiveUsers: ContactArray [] = [];\n\n  public ActiveUrl:any;\n\n  public CheckIfuserLogin = false;\n\n\n public async ngOnInit() \n  { \n    this.ActiveUrl = this.router.url; \n      setTimeout(() => {\n      this.IfLoginExoireToken();\n     },113000);    \n  \n  }\n\n  public checkIfLogin():boolean\n  {\n    if(localStorage.getItem(\"token\") == null)\n    return true;\n\n    else\n    {\n      this.CheckIfuserLogin = true;\n      return false;\n    }\n}\n\n \n\n public async IfLoginExoireToken()\n {\n  let user  = localStorage.getItem(\"User\")\n  this.SaveLoginUserIfJWT=  await this.Authentication_permissionService.GetNewUserCreditionalIfTokenUser_ExpireDate(user);\n  this.creditionals.username = this.SaveLoginUserIfJWT.user_name;\n  this.creditionals.password = this.SaveLoginUserIfJWT.pass;\n  this.AddUser.name = localStorage.getItem(\"User\")?.toString();\n  await this.ContactService.Delete_User(this.AddUser);\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"User\");\n  localStorage.removeItem(\"Command\");\n\n  this.login();\n }\n\n public async AcceseeArea(val?: any)\n  {\n    try\n    { \n    if(typeof localStorage.getItem(\"token\") === 'string')\n    {\n       let ValToken = localStorage.getItem(\"token\")?.toString();\n       if(typeof ValToken === 'string' && typeof ValToken != null)\n        { \n          this.IsAccess = false;\n          if(val == 1)\n          {\n            this.router.navigateByUrl(\"/CCC\");\n            this.IsAccess = false;\n            return;\n          } \n          else if(val == 0)\n          {\n            this.router.navigateByUrl(\"/TaskList\")\n            this.IsAccess = false;\n           return;\n          }\n          else if(val == 3)\n          {\n            this.router.navigateByUrl(this.router.url);\n           this.IsAccess = false;\n           return;\n          }\n        }\n    }\n    this.IsAccess = true;\n    if(val == 1)\n    { \n      this.SelectCCC = true;\n      this.SelectPassdown = false;\n    return;\n    }\n    else if(val == 0)\n    {\n      this.SelectCCC = false;\n      this.SelectPassdown = true;\n      return;\n    }\n    if(val==3)\n    {\n      this.SelectCCC = false;\n      this.SelectPassdown = false;\n      this.router.navigateByUrl(this.router.url);\n    }\n    return;\n  }\n  catch(ex: any)\n  {\n    alert(ex.message);\n    this.AddUser.name = localStorage.getItem(\"User\")?.toString();\n    await this.ContactService.Delete_User(this.AddUser);\n    localStorage.removeItem(\"User\");\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"Command\");\n    this.IsAccess = true;\n    this.router.navigateByUrl(\"/Home\");\n  }\n\n  }\n\n\n public async login()\n  {\n    try\n    {\n        this.ActiveUsers = await this.ContactService.GetAllUsers();\n        let counter = 0;\n        this.ActiveUsers.map((x) =>{\n        if(x.name == this.creditionals.username)\n          counter++;\n        });\n        if(counter > 0)\n        {\n          this.IfUserIsActive = true;\n          setTimeout(() =>{\n            this.IfUserIsActive = false;\n          },4000)\n          this.creditionals.username=\"\";\n          this.creditionals.password=\"\";\n          this.IsAccess = true;\n        }\n else\n  {    \n      this.Authentication_permissionsUser = (await this.Authentication_permissionService.GotToken(this.creditionals));\n      \n      if(this.Authentication_permissionsUser.user_name!= null && this.Authentication_permissionsUser.jwt_token != null)\n      {\n        this.saveUser.username    = this.Authentication_permissionsUser.first_name\n        this.saveUser.jwt         = this.Authentication_permissionsUser.jwt_token;\n        this.saveUser.RoleCommand = this.Authentication_permissionsUser._command;\n        if(this.saveUser.username != null && this.saveUser.jwt != null && this.saveUser.RoleCommand != null)\n        {\n             localStorage.setItem(\"token\" , this.saveUser.jwt);\n             localStorage.setItem(\"User\",this.saveUser.username);\n             localStorage.setItem(\"Command\", this.saveUser.RoleCommand)\n             this.IsAccess = false;\n             this.AddUser.name = localStorage.getItem(\"User\")?.toString();\n             await this.ContactService.AddUser(this.AddUser);\n             if(this.SelectCCC == true && this.SelectPassdown == false)\n             {\n              if(typeof localStorage.getItem(\"User\") != null && typeof localStorage.getItem(\"User\") === 'string')\n              {\n                this.router.navigateByUrl(\"/CCC\");\n                return;\n              }\n              return;              \n             }\n             else if(this.SelectCCC == false && this.SelectPassdown == true)\n             {\n              this.router.navigateByUrl(\"/TaskList\");\n              return;\n             }\n             else\n             {\n               this.router.navigateByUrl(this.router.url);\n             return;\n             }   \n           }      \n         }     \n        }\n      }\n    catch(ex: any)\n    {\n      if(ex.status == 401 || ex.status == 403 || ex.status == 400)\n      this.IfUnauthorized = true;\n\n      else\n      alert(\"Some error ocuured, pls try again later\");\n      await this.ContactService.Delete_User(this.AddUser);\n      localStorage.removeItem(\"User\");\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"Command\");\n\n      this.IsAccess = true;\n      this.router.navigateByUrl(\"/Home\");\n    }\n  }\n\n   cancel()\n  {\n    this.IsAccess = false;\n  }\n\n  ShowPass()\n  {\n    document.getElementById(\"pass\")?.setAttribute(\"type\", \"text\");\n    this.ToShowPass = false;\n    this.ToHidePass = true;\n  }\n\n  HidePass()\n  {\n      \n    document.getElementById(\"pass\")?.setAttribute(\"type\", \"password\");\n    this.ToShowPass = true;\n    this.ToHidePass = false;\n    \n  }\n\n  Hide_Alarm_Authorized()\n  {\n    this.IfUnauthorized = false;\n    this.router.navigateByUrl(\"/Home\");\n\n  }\n\n  CheckIfStart(val: any)\n  {\n    \n    if(val.target.value.length > 0)\n    {\n       this.ToShowPass = true;\n       this.ToHidePass = false;\n    }\n\n    else\n    {\n      this.ToShowPass = false;\n      this.ToHidePass = false;\n      document.getElementById(\"pass\")?.setAttribute(\"type\", \"password\");\n    }\n     \n  }\n\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}